{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.heimgewebe.org/contracts/events/heimgeist.insight.v1.schema.json",
  "title": "Heimgeist Insight Event",
  "description": "Ein Insight-Event, das von Heimgeist produziert wird, um Erkenntnisse, Risiken oder Meta-Analysen in die Chronik zu schreiben.",
  "x-producers": ["heimgeist"],
  "x-consumers": ["chronik", "leitstand"],
  "type": "object",
  "required": ["id", "type", "timestamp", "producer", "payload"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Eindeutige Event-ID (UUID)"
    },
    "type": {
      "type": "string",
      "const": "heimgeist.insight",
      "description": "Fester Event-Typ"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Zeitpunkt der Erzeugung (ISO 8601)"
    },
    "producer": {
      "type": "string",
      "const": "heimgeist",
      "description": "Erzeuger-Komponente"
    },
    "schema_version": {
      "type": "string",
      "const": "v1",
      "description": "Schema-Version zur Breaking-Change-Erkennung"
    },
    "payload": {
      "type": "object",
      "description": "Nutzlast des Insights",
      "required": ["insight_type", "summary", "details"],
      "properties": {
        "insight_type": {
          "type": "string",
          "enum": ["risk", "drift", "pattern", "anomaly", "meta"],
          "description": "Kategorie des Insights"
        },
        "summary": {
          "type": "string",
          "description": "Kurze Zusammenfassung für Logs/Dashboards"
        },
        "details": {
          "type": "string",
          "description": "Ausführliche Beschreibung (Markdown erlaubt)"
        },
        "context_refs": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Referenzen auf andere Events, Dateien oder PRs"
        },
        "confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Konfidenz der Erkenntnis (0.0 - 1.0)"
        }
      }
    }
  },
  "additionalProperties": false
}
