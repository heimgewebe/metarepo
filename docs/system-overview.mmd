%% Heimgewebe – Systemübersicht (Mermaid)
flowchart LR
  subgraph Core Fleet
    META["metarepo
Control-Plane
Contracts/CI/Templates"]
    WGX["wgx
System-Tasks
Metrics Snapshots"]
    HKI["hausKI
Orchestrator
State/Jobs/Decisions"]
    HLN["heimlern
Policies/Bandits
why/score"]
    SEMA["semantAH
Insights/Graph"]
    HKA["hausKI-audio
Audio Events/Sessions"]
    AUSS["aussensensor
Außen-Events
feed.jsonl"]
    CHRONIK["chronik
HTTP Ingest
Event-Store"]
    LEIT["leitstand
UI/Dashboard"]

    CHRONIK --> LEIT
  end

  subgraph Related
    WELT["weltgewebe
Community/Maps
(related)"]
    VAULT["vault-gewebe
persönlicher Vault
(nicht Fleet)"]
  end

  %% Datenflüsse
  AUSS -- aussen.event --> CHRONIK
  AUSS -- aussen.event --> HLN
  WELT -- optional events --> AUSS
  WGX -- metrics.snapshot --> HKI
  WGX -- metrics.snapshot --> CHRONIK
  SEMA -- insights --> HKI
  SEMA -- insights --> CHRONIK
  HKA -- audio.events --> HKI
  HKA -- audio.events --> CHRONIK
  HKI -- decide(ctx) --> HLN
  HLN -- action/why --> HKI
  HKI -- playbooks --> WGX
  HKI -- audio-control --> HKA

  %% Verträge
  classDef contract fill:#eef,stroke:#99c,stroke-width:1px,color:#334;
  class WGX,SEMA,HKA,AUSS,HKI,HLN contract;
