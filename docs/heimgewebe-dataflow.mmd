```mermaid
%%{init: {'theme':'neutral'}}%%
flowchart LR
    subgraph Producer
      SEM[semantAH insights/today.json]
      WGX[wgx metrics.json Snapshot]
      AUD[hausKI-audio audio.session_* audio.latency_ms]
      AUS[aussensensor export/feed.jsonl]
    end

    subgraph Core
      HKI[hausKI State SQLite Events]
      HLM[heimlern Decisions]
    end

    subgraph Persistence_UI["Persistenz & UI"]
      CHRONIK[chronik /data/domain.jsonl]
      LST[leitstand UI/Dashboard]
      CHRONIK -- "Events" --> LST
    end

    subgraph Meta
      META[metarepo\ncontracts/*.schema.json]
    end

    %% Contracts (Schemas)
    META ---|insights.schema.json| SEM
    META ---|metrics.snapshot.schema.json| WGX
    META ---|audio.events.schema.json| AUD
    META ---|aussen.event.schema.json| AUS
    META ---|event.line.schema.json| HKI
    META ---|policy.decision.schema.json| HLM

    %% Flows
    SEM -->|insights/today.json| HKI
    SEM -->|insights/today.json| CHRONIK

    WGX -->|metrics.json| HKI
    HKI -->|/v1/ingest/metrics append Event| HKI

    AUD -->|audio.events| HKI
    AUD -->|audio.events| CHRONIK

    AUS -->|feed.jsonl â†’ HTTP /ingest/aussen| CHRONIK

    HKI -->|/v1/policy/decide| HLM
    HLM -->|{action,score,why}| HKI
    HKI -->|/v1/policy/feedback {reward}| HLM

    HKI -->|events JSONL| CHRONIK
```
