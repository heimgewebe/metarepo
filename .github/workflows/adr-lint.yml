---
name: adr-lint

permissions:
  contents: read

concurrency:
  group: adr-lint-${{ github.ref }}
  cancel-in-progress: true

defaults:
  run:
    shell: bash --noprofile --norc -euo pipefail {0}

'on':
  pull_request:
    paths:
      - 'docs/adrs/**'
  workflow_dispatch:

jobs:
  lint:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Run ADR lint script
        run: |
          if [-x tools/adr-lint.sh]; then
            tools/adr-lint.sh
          else
            echo "::error::tools/adr-lint.sh not found or not executable."
            echo "hint: lokal 'just adr-lint' ausprobieren und sicherstellen, dass tools/adr-lint.sh vorhanden und ausfÃ¼hrbar ist." >&2
            exit 1
          fi
